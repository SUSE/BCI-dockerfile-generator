<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Creating packages on OBS &#8212; bci-build-templates  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Staging Bot" href="staging_bot.html" />
    <link rel="prev" title="Adding and Modifying Container Images" href="adding_containers.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="creating-packages-on-obs">
<h1>Creating packages on OBS<a class="headerlink" href="#creating-packages-on-obs" title="Permalink to this heading">¶</a></h1>
<p>The <code class="file docutils literal notranslate"><span class="pre">./src/bci_build/update.py</span></code> script can automatically submit updates to
existing packages on OBS or IBS, but it will fail to create new ones that have
just been added as code.</p>
<p>If you want to create a new Container Image on OBS, then proceed as follows:</p>
<ol class="arabic simple">
<li><p>Ensure that your Container Image has been created as code (see
<a class="reference internal" href="adding_containers.html#adding-and-modifying-container-images"><span class="std std-ref">Adding and Modifying Container Images</span></a>)</p></li>
<li><p>Create a new project on OBS in which you will create the initial package
version. Usually the easiest way how to achieve this, is to branch an
existing package into your home project (we use <code class="docutils literal notranslate"><span class="pre">busybox-image</span></code> below),
as that will ensure that the repositories have been setup correctly.
Once you have created it, check it out to your file system:</p></li>
</ol>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>osc<span class="w"> </span>branch<span class="w"> </span>devel:BCI:SLE-15-SP4<span class="w"> </span>busybox-image<span class="w"> </span>home:<span class="nv">$my_user</span>:new_pkg_proj
<span class="gp">$ </span>osc<span class="w"> </span>co<span class="w"> </span>home:<span class="nv">$my_user</span>:new_pkg_proj
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Create a new package in the checked out project. You <strong>must</strong> give it the
same name as the parameter
<a class="reference internal" href="api.html#bci_build.package.BaseContainerImage.package_name" title="bci_build.package.BaseContainerImage.package_name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">package_name</span></code></a> in the
respective Container class, as otherwise the updater script will not work properly:</p></li>
</ol>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>osc<span class="w"> </span>mkpac<span class="w"> </span><span class="nv">$new_pkg_name</span>
</pre></div>
</div>
<ol class="arabic" start="4">
<li><p>Run the script <strong class="command">./src/bci_build/package.py</strong> as follows:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>poetry<span class="w"> </span>run<span class="w"> </span>./src/bci_build/package.py<span class="w"> </span><span class="nv">$new_container_nvr</span>-<span class="nv">$SP_ID</span><span class="w"> </span>path_to_checkout_of_new_pkg_name
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">$new_container_nvr</span></code> is the value of the
<a class="reference internal" href="api.html#bci_build.package.BaseContainerImage.uid" title="bci_build.package.BaseContainerImage.uid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">uid</span></code></a> property of your
container class (this one is either the
<a class="reference internal" href="api.html#bci_build.package.BaseContainerImage.name" title="bci_build.package.BaseContainerImage.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code></a> property or
<a class="reference internal" href="api.html#bci_build.package.BaseContainerImage.name" title="bci_build.package.BaseContainerImage.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code></a> <code class="docutils literal notranslate"><span class="pre">-</span></code>
<a class="reference internal" href="api.html#bci_build.package.LanguageStackContainer.version" title="bci_build.package.LanguageStackContainer.version"><code class="xref py py-attr docutils literal notranslate"><span class="pre">version</span></code></a>, depending on
the type of the container) and <code class="docutils literal notranslate"><span class="pre">$SP_ID</span></code> the identifier of this service pack
(e.g. <code class="docutils literal notranslate"><span class="pre">sp4</span></code> or <code class="docutils literal notranslate"><span class="pre">sp3</span></code>). You can find all available containers via
<strong class="command">poetry ./src/bci_build/package.py --help</strong>.</p>
<p><code class="docutils literal notranslate"><span class="pre">path_to_checkout_of_new_pkg_name</span></code> is the path where you have checked out
the <em>package</em> <code class="docutils literal notranslate"><span class="pre">$new_pkg_name</span></code> to.</p>
</li>
<li><p>Add a changelog entry mentioning the Jira ticket requesting this container,
add all files, commit your changes and send a submit request back to the
<code class="docutils literal notranslate"><span class="pre">devel:BCI</span></code> project:</p></li>
</ol>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>osc<span class="w"> </span>vc<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Initial version of the ... Container, jsc#BCI-XXX&quot;</span>
<span class="gp">$ </span>osc<span class="w"> </span>add<span class="w"> </span>*
<span class="gp">$ </span>osc<span class="w"> </span>ci<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Initial version of the ... Container, jsc#BCI-XXX&quot;</span>
<span class="gp">$ </span>osc<span class="w"> </span>sr<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;Initial version of the ... Container, jsc#BCI-XXX&quot;</span><span class="w"> </span>devel:BCI:SLE-15-SP4<span class="w"> </span><span class="nv">$new_pkg_name</span>
</pre></div>
</div>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">bci-build-templates</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="adding_containers.html">Adding and Modifying Container Images</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Creating packages on OBS</a></li>
<li class="toctree-l1"><a class="reference internal" href="staging_bot.html">Staging Bot</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Documentation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="adding_containers.html" title="previous chapter">Adding and Modifying Container Images</a></li>
      <li>Next: <a href="staging_bot.html" title="next chapter">Staging Bot</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Dan Čermák.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/creating_packages.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>